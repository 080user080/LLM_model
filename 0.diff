*** a/tets.py
--- b/tets.py
@@
-    # Збираємо назад
-    final_text = ''.join(new_paragraphs)
-
-    # Очищення пробілів і зайвих переносів
-    final_text = re.sub(r'[ \t]+', ' ', final_text)
-    final_text = re.sub(r'\n{3,}', '\n\n', final_text).strip() + "\n"
+    # Збираємо назад
+    final_text = ''.join(new_paragraphs)
+
+    # ВИПРАВЛЕННЯ: прибираємо пробіли/переноси перед знаками пунктуації,
+    # щоб не опинити крапку або кому на окремому рядку перед тегом.
+    final_text = re.sub(r'\s+([.,?!])', r'\1', final_text)
+
+    # Очищення пробілів і зайвих переносів
+    final_text = re.sub(r'[ \t]+', ' ', final_text)
+    final_text = re.sub(r'\n{3,}', '\n\n', final_text).strip() + "\n"
*** End Patch
